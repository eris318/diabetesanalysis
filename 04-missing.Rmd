# Missing values
```{r}
library(naniar)
library(tidyverse)
library(dplyr)
diabetes_new <- diabetes1 %>%
  filter(Year==2018)
diabetes_new <- diabetes_new %>%
  replace_with_na_all(condition = ~.x=="No Data")
library(redav)
plot_missing(diabetes_new, percent = FALSE)
```
```{r}
diabetes_yes <- questionnaire18[questionnaire18$DIQ010==1,]
diabetes_yes_missing <- diabetes_yes %>% 
  gather(key="key",value = "value",-SEQN) %>% 
  mutate(missing = ifelse(is.na(value), "yes", "no"))


ggplot(diabetes_yes_missing,aes(x = fct_rev(fct_inorder(key)), y = SEQN, fill = missing)) +
  geom_tile(stat = "identity",position = "fill") + 
  scale_fill_manual(values = c("red","black"))+
  coord_flip()+
  theme_classic()+
  ggtitle("Missing pattern in questionnaire data")+
  xlab("Question Code")+
  ylab("Respondent sequence number")
```

